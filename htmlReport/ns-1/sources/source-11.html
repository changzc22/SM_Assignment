


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > TrainUITest</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">test</a>
</div>

<h1>Coverage Summary for Class: TrainUITest (test)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">TrainUITest</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (15/15)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (93/93)
  </span>
</td>
</tr>
  <tr>
    <td class="name">TrainUITest$InMemoryTrainRepository</td>
<td class="coverageStat">
  <span class="percent">
    66.7%
  </span>
  <span class="absValue">
    (2/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    60%
  </span>
  <span class="absValue">
    (3/5)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    94.4%
  </span>
  <span class="absValue">
    (17/18)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    98%
  </span>
  <span class="absValue">
    (96/98)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package test;
&nbsp;
&nbsp;import oopt.assignment.model.Train;
&nbsp;import oopt.assignment.model.TrainCreationRequest;
&nbsp;import oopt.assignment.model.TrainInterface;
&nbsp;import oopt.assignment.model.TrainStatus;
&nbsp;import oopt.assignment.service.TrainService;
&nbsp;import oopt.assignment.service.TrainValidator;
&nbsp;import oopt.assignment.ui.TrainUI;
&nbsp;import org.junit.jupiter.api.AfterEach;
&nbsp;import org.junit.jupiter.api.BeforeEach;
&nbsp;import org.junit.jupiter.api.Test;
&nbsp;
&nbsp;import java.io.*;
&nbsp;import java.lang.reflect.Method;
&nbsp;import java.time.LocalDate;
&nbsp;import java.time.LocalTime;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;import java.util.Scanner;
&nbsp;
&nbsp;import static org.junit.jupiter.api.Assertions.*;
&nbsp;
&nbsp;/**
&nbsp; * Tests for TrainUI
&nbsp; */
<b class="fc">&nbsp;class TrainUITest {</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Simple repository so TrainService does not touch the file system.
&nbsp;     */
<b class="fc">&nbsp;    private static class InMemoryTrainRepository implements TrainInterface {</b>
<b class="fc">&nbsp;        private final List&lt;Train&gt; store = new ArrayList&lt;&gt;();</b>
&nbsp;
&nbsp;        @Override
&nbsp;        public List&lt;Train&gt; loadAll() {
<b class="fc">&nbsp;            return new ArrayList&lt;&gt;(store);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void saveAll(List&lt;Train&gt; trains) {
<b class="nc">&nbsp;            store.clear();</b>
<b class="nc">&nbsp;            store.addAll(trains);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    private final ByteArrayOutputStream outContent = new ByteArrayOutputStream();</b>
&nbsp;    private PrintStream originalOut;
&nbsp;
&nbsp;    @BeforeEach
&nbsp;    void setUpStreams() {
<b class="fc">&nbsp;        originalOut = System.out;</b>
<b class="fc">&nbsp;        System.setOut(new PrintStream(outContent));</b>
&nbsp;    }
&nbsp;
&nbsp;    @AfterEach
&nbsp;    void restoreStreams() {
<b class="fc">&nbsp;        System.setOut(originalOut);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Utility method to invoke a private method on TrainUI.
&nbsp;     */
&nbsp;    private Object invokePrivate(
&nbsp;            TrainUI ui,
&nbsp;            String methodName,
&nbsp;            Class&lt;?&gt;[] paramTypes,
&nbsp;            Object... args
&nbsp;    ) throws Exception {
<b class="fc">&nbsp;        Method m = TrainUI.class.getDeclaredMethod(methodName, paramTypes);</b>
<b class="fc">&nbsp;        m.setAccessible(true);</b>
<b class="fc">&nbsp;        return m.invoke(ui, args);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Creates a TrainService with an in-memory repository for use by TrainUI.
&nbsp;     */
&nbsp;    private TrainService createInMemoryService() {
<b class="fc">&nbsp;        InMemoryTrainRepository repo = new InMemoryTrainRepository();</b>
<b class="fc">&nbsp;        repo.store.add(new Train(</b>
&nbsp;                &quot;T001&quot;, &quot;Penang&quot;,
<b class="fc">&nbsp;                LocalDate.of(2030, 1, 1),</b>
<b class="fc">&nbsp;                LocalTime.of(10, 0),</b>
&nbsp;                100, 20,
&nbsp;                50.0, 120.0,
&nbsp;                TrainStatus.ACTIVE
&nbsp;        ));
<b class="fc">&nbsp;        return new TrainService(repo, new TrainValidator());</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that readInt re-prompts on invalid input and eventually returns a valid integer.
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testReadIntRetriesOnInvalidInput() throws Exception {
<b class="fc">&nbsp;        String input = &quot;abc\n42\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        int result = (int) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;readInt&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class},
&nbsp;                &quot;Enter number: &quot;
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertEquals(42, result);</b>
&nbsp;
<b class="fc">&nbsp;        String output = outContent.toString();</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Enter number:&quot;));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that readDouble re-prompts on invalid input and returns a valid double.
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testReadDoubleRetriesOnInvalidInput() throws Exception {
<b class="fc">&nbsp;        String input = &quot;xyz\n3.14\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        double result = (double) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;readDouble&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class},
&nbsp;                &quot;Enter amount: &quot;
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertEquals(3.14, result, 0.0001);</b>
&nbsp;
<b class="fc">&nbsp;        String output = outContent.toString();</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Enter amount:&quot;));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that readIntWithSentinel returns null when sentinel value is entered.
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testReadIntWithSentinelReturnsNullOnSentinel() throws Exception {
<b class="fc">&nbsp;        String input = &quot;-1\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        Integer result = (Integer) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;readIntWithSentinel&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class, int.class},
&nbsp;                &quot;Enter quantity: &quot;,
<b class="fc">&nbsp;                -1</b>
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertNull(result);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that readIntWithSentinel returns the parsed integer when not sentinel.
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testReadIntWithSentinelReturnsValueWhenNotSentinel() throws Exception {
<b class="fc">&nbsp;        String input = &quot;10\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        Integer result = (Integer) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;readIntWithSentinel&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class, int.class},
&nbsp;                &quot;Enter quantity: &quot;,
<b class="fc">&nbsp;                -1</b>
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertEquals(10, result);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that readDoubleWithSentinel returns null when sentinel is entered.
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testReadDoubleWithSentinelReturnsNullOnSentinel() throws Exception {
<b class="fc">&nbsp;        String input = &quot;-1.0\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        Double result = (Double) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;readDoubleWithSentinel&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class, double.class},
&nbsp;                &quot;Enter price: &quot;,
<b class="fc">&nbsp;                -1.0</b>
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertNull(result);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that readDoubleWithSentinel returns the parsed double for non-sentinel value.
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testReadDoubleWithSentinelReturnsValueWhenNotSentinel() throws Exception {
<b class="fc">&nbsp;        String input = &quot;99.50\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        Double result = (Double) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;readDoubleWithSentinel&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class, double.class},
&nbsp;                &quot;Enter price: &quot;,
<b class="fc">&nbsp;                -1.0</b>
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertEquals(99.50, result, 0.0001);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that askYesNo keeps re-prompting until a valid Y/N is entered
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testAskYesNoAcceptsYAndNAndRetriesOnInvalid() throws Exception {
<b class="fc">&nbsp;        String input = &quot;maybe\nY\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        boolean result = (boolean) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;askYesNo&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class},
&nbsp;                &quot;Confirm?&quot;
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertTrue(result);</b>
&nbsp;
<b class="fc">&nbsp;        String output = outContent.toString();</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Confirm? (Y/N):&quot;));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that confirmChange prints the &quot;From&quot; and &quot;To&quot; values
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testConfirmChangePrintsContextAndUsesAskYesNo() throws Exception {
<b class="fc">&nbsp;        String input = &quot;Y\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        boolean confirmed = (boolean) invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;confirmChange&quot;,
&nbsp;                new Class&lt;?&gt;[]{String.class, String.class, String.class},
&nbsp;                &quot;Standard Seat Quantity&quot;,
&nbsp;                &quot;100&quot;,
&nbsp;                &quot;120&quot;
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        assertTrue(confirmed);</b>
&nbsp;
<b class="fc">&nbsp;        String output = outContent.toString();</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Standard Seat Quantity From : 100&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;To   : 120&quot;));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that displayAddContext prints only the fields that are non-default
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testDisplayAddContextPrintsOnlyFilledFields() throws Exception {
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(new byte[0]));</b>
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        TrainCreationRequest req = new TrainCreationRequest();</b>
<b class="fc">&nbsp;        req.trainId = &quot;T999&quot;;</b>
<b class="fc">&nbsp;        req.destination = &quot;Penang&quot;;</b>
<b class="fc">&nbsp;        req.departureDate = LocalDate.of(2031, 1, 1);</b>
<b class="fc">&nbsp;        req.departureTime = LocalTime.of(9, 0);</b>
<b class="fc">&nbsp;        req.standardSeatQty = 100;</b>
<b class="fc">&nbsp;        req.standardSeatPrice = 60.0;</b>
&nbsp;
<b class="fc">&nbsp;        invokePrivate(</b>
&nbsp;                ui,
&nbsp;                &quot;displayAddContext&quot;,
&nbsp;                new Class&lt;?&gt;[]{TrainCreationRequest.class},
&nbsp;                req
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        String output = outContent.toString();</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Train ID        : T999&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Destination     : Penang&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Departure Date  : 2031-01-01&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Departure Time  : 09:00&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Standard Seat Quantity  : 100&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Standard Seat Price     : RM 60.00&quot;));</b>
<b class="fc">&nbsp;        assertFalse(output.contains(&quot;Premium Seat Quantity&quot;));</b>
<b class="fc">&nbsp;        assertFalse(output.contains(&quot;Premium Seat Price&quot;));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Verifies that showMenu displays the menu once and returns when the user chooses &quot;Return&quot;.
&nbsp;     */
&nbsp;    @Test
&nbsp;    void testShowMenuReturnImmediately() {
<b class="fc">&nbsp;        String input = &quot;5\n&quot;;</b>
<b class="fc">&nbsp;        Scanner scanner = new Scanner(new ByteArrayInputStream(input.getBytes()));</b>
&nbsp;
<b class="fc">&nbsp;        TrainUI ui = new TrainUI(createInMemoryService(), scanner);</b>
&nbsp;
<b class="fc">&nbsp;        ui.showMenu();</b>
&nbsp;
<b class="fc">&nbsp;        String output = outContent.toString();</b>
&nbsp;
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Train Information Module&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Add New Train&quot;));</b>
<b class="fc">&nbsp;        assertTrue(output.contains(&quot;Return to Main Menu&quot;));</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-12-02 23:29</div>
</div>
</body>
</html>
